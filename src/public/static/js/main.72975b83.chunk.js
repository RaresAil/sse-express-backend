(this["webpackJsonpsse-express-frontend"]=this["webpackJsonpsse-express-frontend"]||[]).push([[0],{230:function(e,t,n){},268:function(e,t,n){"use strict";n.r(t);var a=n(60),s=n(46),r=n.n(s),i=n(122),c=n.n(i),o=(n(230),n(104)),u=n.n(o),d=n(140),l=n(179),p=n(142),f=n(143),v=n(147),h=n(145),j=function(e){Object(v.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(p.a)(this,n);for(var a=arguments.length,s=new Array(a),r=0;r<a;r++)s[r]=arguments[r];return(e=t.call.apply(t,[this].concat(s))).state={loading:!1,idField:""},e.login=function(){var t=Object(d.a)(u.a.mark((function t(n){var a;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.preventDefault(),!e.state.loading){t.next=3;break}return t.abrupt("return");case 3:return e.setState({loading:!0}),t.next=6,fetch("/api/v1/sse/login/".concat(e.state.idField));case 6:return t.next=8,t.sent.json();case 8:(null===(a=t.sent)||void 0===a?void 0:a.success)?window.location.reload():(alert(null===a||void 0===a?void 0:a.message),e.setState({loading:!1}));case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(f.a)(n,[{key:"render",value:function(){var e=this;return Object(a.jsxs)("div",{style:{display:"felx",flexDirection:"row"},children:[Object(a.jsx)("div",{style:{fontSize:"14px",paddingBottom:"10px"},children:"To register, login with an empty id"}),Object(a.jsxs)("form",{style:{display:"inline-block"},onSubmit:this.login,children:[Object(a.jsx)("input",{value:this.state.idField,placeholder:"Id",onChange:function(t){var n=t.target.value;e.setState({idField:n})},disabled:this.state.loading}),Object(a.jsx)("button",{disabled:this.state.loading,type:"submit",children:"Login"})]})]})}}]),n}(s.Component),b=n(180),g=n(224),y=(n(232),n(223));function O(e){return Object(a.jsx)(y.a,{licenseKey:"non-commercial-and-evaluation",data:e.data.map((function(e){var t=e.country,n=e.code,a=e.currency,s=e.level,r=e.units,i=e.total,c=e.quantity;return[t,n,a,s.toFixed(3),r,i,c]})),colHeaders:["Country","Code","Currency","Level","Units","Total","Quantity"],rowHeaders:!0,beforeChange:function(t,n){var a,s=Object(g.a)(t[0],4),r=s[0],i=s[1],c=s[2],o=s[3];if("edit"===n&&c!==o&&6===i){var u=null===(a=e.data[r])||void 0===a?void 0:a.id;u&&fetch("/api/v1/sse/quantity/".concat(u),{headers:{"Content-Type":"application/json"},body:JSON.stringify({quantity:parseInt(o)}),method:"PUT"})}},cells:function(e,t){var n={};return 6!==t&&(n=Object(b.a)(Object(b.a)({},n),{},{readOnly:!0})),n}})}var x=function(e){Object(v.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(p.a)(this,n);for(var a=arguments.length,s=new Array(a),r=0;r<a;r++)s[r]=arguments[r];return(e=t.call.apply(t,[this].concat(s))).state={nests:[],loading:!0,message:"Loading...",userId:"",requestLogin:!1},e.updateNests=function(t){if(Array.isArray(t))e.setState({nests:t});else{var n=e.state.nests.findIndex((function(e){return e.id===t.id}));if(n>=0){var a=Object(l.a)(e.state.nests);a[n]=t,e.setState({nests:a})}else e.setState({nests:[].concat(Object(l.a)(e.state.nests),[t])})}},e}return Object(f.a)(n,[{key:"componentDidMount",value:function(){var e=Object(d.a)(u.a.mark((function e(){var t,n,a=this;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/v1/sse/me",{method:"GET"});case 2:return e.next=4,e.sent.json();case 4:if(t=e.sent,n=t.userId){e.next=8;break}return e.abrupt("return",this.setState({requestLogin:!0,message:""}));case 8:new EventSource("/api/v1/sse/events").onmessage=function(e){a.updateNests(JSON.parse(e.data))},this.setState({loading:!1,userId:n});case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return this.state.requestLogin?Object(a.jsx)(j,{}):this.state.loading?Object(a.jsx)("div",{children:this.state.message}):Object(a.jsxs)("div",{className:"app",children:[Object(a.jsxs)("div",{children:["User: ",this.state.userId]}),Object(a.jsx)(O,{data:this.state.nests})]})}}]),n}(s.Component),m=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,269)).then((function(t){var n=t.getCLS,a=t.getFID,s=t.getFCP,r=t.getLCP,i=t.getTTFB;n(e),a(e),s(e),r(e),i(e)}))};c.a.render(Object(a.jsx)(r.a.StrictMode,{children:Object(a.jsx)(x,{})}),document.getElementById("root")),m()}},[[268,1,2]]]);
//# sourceMappingURL=main.72975b83.chunk.js.map